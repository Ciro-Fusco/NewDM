<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CassaController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">NewDMApp</a> &gt; <a href="index.source.html" class="el_package">presentazione</a> &gt; <span class="el_source">CassaController.java</span></div><h1>CassaController.java</h1><pre class="source lang-java linenums">package presentazione;

import business.cassa.Scontrino;
import exceptions.DatabaseException;
import exceptions.ProdottoException;
import exceptions.ScontrinoException;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Label;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.input.MouseEvent;
import business.utenza.Utente;

import java.io.IOException;
import java.net.URL;
import java.util.ResourceBundle;

<span class="fc" id="L19">public class CassaController implements Initializable {</span>

  private static Scontrino scontrino;
  @FXML private TextField codiceProd;
  @FXML private TextArea scontrinoTextField;
  @FXML private TextField sommaVersataTextField;
  @FXML private Label totaleLabel;
  @FXML private TextArea riepilogoTextArea;
  @FXML private Label restoLabel;

  @Override
  public void initialize(URL url, ResourceBundle resourceBundle) {
<span class="fc" id="L31">    String nomeFile =</span>
<span class="fc" id="L32">        url.toString().substring(url.toString().lastIndexOf('/') + 1, url.toString().length());</span>

<span class="fc bfc" id="L34" title="All 2 branches covered.">    if (nomeFile.equals(&quot;Cassa.fxml&quot;)) {</span>
<span class="fc bfc" id="L35" title="All 2 branches covered.">      if (scontrino != null) {</span>
<span class="fc" id="L36">        scontrinoTextField.appendText(scontrino.getRiepilogo());</span>
      } else {
<span class="fc" id="L38">        System.out.println();</span>
      }
    } else {
<span class="fc" id="L41">      System.out.println();</span>
    }

<span class="fc bfc" id="L44" title="All 2 branches covered.">    if (nomeFile.equals(&quot;CassaTotaleForm.fxml&quot;)) {</span>
<span class="fc" id="L45">      scontrino.calcolaTot();</span>
<span class="fc" id="L46">      totaleLabel.setText(Double.toString(scontrino.getTot()));</span>
    } else {
<span class="fc" id="L48">      System.out.println();</span>
    }

<span class="fc bfc" id="L51" title="All 2 branches covered.">    if (nomeFile.equals(&quot;CassaRiepilogo.fxml&quot;)) {</span>
<span class="fc bfc" id="L52" title="All 2 branches covered.">      if (scontrino != null) {</span>
<span class="fc" id="L53">        scontrino.calcolaResto();</span>
<span class="fc" id="L54">        restoLabel.setText(String.format(&quot;%.2f&quot;, scontrino.getResto()));</span>
<span class="fc" id="L55">        riepilogoTextArea.setText(scontrino.getRiepilogo());</span>
      } else {
<span class="fc" id="L57">        System.out.println();</span>
      }
    } else {
<span class="fc" id="L60">      System.out.println();</span>
    }
<span class="fc" id="L62">  }</span>

  // CassaController

  /**
   * Apre la dashboard
   *
   * @param mouseEvent
   * @throws IOException
   */
  public void openDashboard(MouseEvent mouseEvent) throws IOException, DatabaseException {
<span class="nc" id="L73">    Utente.logout();</span>
<span class="nc" id="L74">    App.setRoot(&quot;Dashboard&quot;);</span>
<span class="nc" id="L75">  }</span>

  /**
   * Apre la schermata di inserimento del codice Prodotto
   *
   * @param mouseEvent
   * @throws IOException
   */
  public void openCassaInsProdotto(MouseEvent mouseEvent) throws IOException {
<span class="nc" id="L84">    App.setRoot(&quot;CassaInsProdottoForm&quot;);</span>
<span class="nc" id="L85">  }</span>

  /**
   * Apre la schermata di riepilogo dello Scontrino
   *
   * @param mouseEvent
   * @throws IOException
   */
  public void openCassaTotale(MouseEvent mouseEvent) throws IOException {
<span class="fc bfc" id="L94" title="All 4 branches covered.">    if (scontrino != null &amp;&amp; scontrino.getList() != null) {</span>
<span class="nc" id="L95">      App.setRoot(&quot;CassaTotaleForm&quot;);</span>
    } else {
<span class="fc" id="L97">      AlertMessage.showError(&quot;Per procedere, aggiungere almeno un prodotto allo scontrino&quot;);</span>
    }
<span class="fc" id="L99">  }</span>

  /**
   * Elimina lo Scontrino attuale
   *
   * @param mouseEvent
   */
  public void annullaInsProd(MouseEvent mouseEvent) {
<span class="nc" id="L107">    scontrino = new Scontrino();</span>
<span class="nc" id="L108">    scontrinoTextField.setText(&quot;&quot;);</span>
<span class="nc" id="L109">  }</span>
  //////////////////////////////////////////////////////////////////

  // inserimento prodotto

  /**
   * Apre la schermata CassaController
   *
   * @param mouseEvent
   * @throws IOException
   */
  public void openCassa(MouseEvent mouseEvent) throws IOException {
<span class="nc" id="L121">    App.setRoot(&quot;Cassa&quot;);</span>
<span class="nc" id="L122">  }</span>

  /**
   * Inserisce il Prodotto nello scontrino
   *
   * @param mouseEvent
   * @throws ProdottoException Prodotto non trovato
   * @throws DatabaseException Errore nel Database
   */
  public void inserimentoProdotto(MouseEvent mouseEvent)
      throws ProdottoException, DatabaseException {
    try {
<span class="fc bfc" id="L134" title="All 2 branches covered.">      if (scontrino == null) {</span>
<span class="fc" id="L135">        scontrino = new Scontrino();</span>
      } else {
<span class="fc" id="L137">        System.out.println();</span>
      }
      ;
<span class="fc" id="L140">      scontrino.addProdotto(Long.parseLong(codiceProd.getText()));</span>
<span class="fc" id="L141">      AlertMessage.showInformation(&quot;Prodotto inserito correttamente&quot;);</span>
<span class="nc" id="L142">    } catch (NumberFormatException excpt) {</span>
<span class="nc" id="L143">      excpt.printStackTrace();</span>
<span class="nc" id="L144">      AlertMessage.showError(&quot;Compilare i campi in modo corretto&quot;);</span>
<span class="fc" id="L145">    }</span>
<span class="fc" id="L146">  }</span>

  ////////////////////////////////////////////////////////////////

  // Totale cassa

  /**
   * Gestisce l'inserimento della somma versata
   *
   * @param mouseEvent
   * @throws IOException
   * @throws ScontrinoException
   */
  public void openCassaRiepilogo(MouseEvent mouseEvent) throws IOException, ScontrinoException {
<span class="fc bfc" id="L160" title="All 2 branches covered.">    if (sommaVersataTextField.getText().matches(&quot;[0-9]+(\\.[0-9][0-9]?)?&quot;)) {</span>
      try {
<span class="fc" id="L162">        scontrino.setVersato(Double.parseDouble(sommaVersataTextField.getText()));</span>
<span class="nc" id="L163">        App.setRoot(&quot;CassaRiepilogo&quot;);</span>
<span class="nc" id="L164">      } catch (NumberFormatException exception) {</span>
<span class="nc" id="L165">        exception.printStackTrace();</span>
<span class="nc" id="L166">        AlertMessage.showError(&quot;Compila i campi in modo corretto&quot;);</span>
<span class="nc" id="L167">      }</span>
    } else {
<span class="fc" id="L169">      AlertMessage.showError(&quot;Inserisci una somma valida&quot;);</span>
    }
<span class="fc" id="L171">  }</span>

  ////////////////////////////////////////////////////////////////

  // Riepilogo CassaController

  /**
   * Salva lo Scontrino
   *
   * @param mouseEvent
   * @throws DatabaseException
   * @throws IOException
   */
  public void confermaScontrino(MouseEvent mouseEvent) throws DatabaseException, IOException {
<span class="nc" id="L185">    scontrino.save();</span>
<span class="nc" id="L186">    AlertMessage.showInformation(&quot;Scontrino salvato&quot;);</span>
<span class="nc" id="L187">    scontrino = null;</span>
<span class="nc" id="L188">    App.setRoot(&quot;Cassa&quot;);</span>
<span class="nc" id="L189">  }</span>

  /////////////////////////////////////////////////////////////////

  // GET E SETTER PER TEST

  public static Scontrino getScontrino() {
<span class="fc" id="L196">    return scontrino;</span>
  }

  public static void setScontrino(Scontrino scontrino) {
<span class="fc" id="L200">    CassaController.scontrino = scontrino;</span>
<span class="fc" id="L201">  }</span>

  public TextField getCodiceProd() {
<span class="nc" id="L204">    return codiceProd;</span>
  }

  public void setCodiceProd(TextField codiceProd) {
<span class="fc" id="L208">    this.codiceProd = codiceProd;</span>
<span class="fc" id="L209">  }</span>

  public TextArea getScontrinoTextField() {
<span class="fc" id="L212">    return scontrinoTextField;</span>
  }

  public void setScontrinoTextField(TextArea scontrinoTextField) {
<span class="fc" id="L216">    this.scontrinoTextField = scontrinoTextField;</span>
<span class="fc" id="L217">  }</span>

  public TextField getSommaVersataTextField() {
<span class="nc" id="L220">    return sommaVersataTextField;</span>
  }

  public void setSommaVersataTextField(TextField sommaVersataTextField) {
<span class="fc" id="L224">    this.sommaVersataTextField = sommaVersataTextField;</span>
<span class="fc" id="L225">  }</span>

  public Label getTotaleLabel() {
<span class="fc" id="L228">    return totaleLabel;</span>
  }

  public void setTotaleLabel(Label totaleLabel) {
<span class="fc" id="L232">    this.totaleLabel = totaleLabel;</span>
<span class="fc" id="L233">  }</span>

  public TextArea getRiepilogoTextArea() {
<span class="fc" id="L236">    return riepilogoTextArea;</span>
  }

  public void setRiepilogoTextArea(TextArea riepilogoTextArea) {
<span class="fc" id="L240">    this.riepilogoTextArea = riepilogoTextArea;</span>
<span class="fc" id="L241">  }</span>

  public Label getRestoLabel() {
<span class="fc" id="L244">    return restoLabel;</span>
  }

  public void setRestoLabel(Label restoLabel) {
<span class="fc" id="L248">    this.restoLabel = restoLabel;</span>
<span class="fc" id="L249">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>